

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. Tips to using auto_arima &mdash; pmdarima 1.2.0.dev0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/fields.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/gitcontrib.css" type="text/css" />
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Toy time-series datasets" href="modules/datasets.html" />
    <link rel="prev" title="5. Refreshing your ARIMA models" href="refreshing.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pmdarima
          

          
          </a>

          
            
            
              <div class="version">
                1.2.0.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="modules/classes.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user_guide.html">User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="user_guide.html#getting-started">Getting started</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="about.html">1. About the project</a></li>
<li class="toctree-l3"><a class="reference internal" href="setup.html">2. Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html">3. Quickstart</a></li>
<li class="toctree-l3"><a class="reference internal" href="serialization.html">4. Serializing your ARIMA models</a></li>
<li class="toctree-l3"><a class="reference internal" href="refreshing.html">5. Refreshing your ARIMA models</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">6. Tips to using <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#understand-p-d-and-q">6.1. Understand <code class="docutils literal notranslate"><span class="pre">p</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, and <code class="docutils literal notranslate"><span class="pre">q</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#enforcing-stationarity">6.2. Enforcing stationarity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#understand-p-d-q-and-m">6.3. Understand <code class="docutils literal notranslate"><span class="pre">P</span></code>, <code class="docutils literal notranslate"><span class="pre">D</span></code>, <code class="docutils literal notranslate"><span class="pre">Q</span></code> and <code class="docutils literal notranslate"><span class="pre">m</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parallel-vs-stepwise">6.4. Parallel vs. stepwise</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modules/datasets.html">7. Toy time-series datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html">8. Contributing to pmdarima</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributors.html">9. Contributors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_guide.html#api-reference">API reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="whats_new.html">What's New?</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pmdarima</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="user_guide.html">User Guide</a> &raquo;</li>
        
      <li>6. Tips to using <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tips_and_tricks.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tips-to-using-auto-arima">
<span id="tips-and-tricks"></span><h1>6. Tips to using <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code><a class="headerlink" href="#tips-to-using-auto-arima" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code> function fits the best <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> model to a univariate time
series according to either
<a class="reference external" href="https://en.wikipedia.org/wiki/Akaike_information_criterion">AIC</a>,
<a class="reference external" href="https://en.wikipedia.org/wiki/Akaike_information_criterion#AICc">AICc</a>,
<a class="reference external" href="https://en.wikipedia.org/wiki/Bayesian_information_criterion">BIC</a> or
<a class="reference external" href="https://en.wikipedia.org/wiki/Hannan–Quinn_information_criterion">HQIC</a>.
The function performs a search (either stepwise or parallelized)
over possible model orders within the constraints provided.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code> function can be daunting. There are a lot of parameters to
tune, and the outcome is heavily dependent on a number of them. In this section,
we lay out several considerations you’ll want to make when you fit your ARIMA
models.</p>
<div class="section" id="understand-p-d-and-q">
<h2>6.1. Understand <code class="docutils literal notranslate"><span class="pre">p</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, and <code class="docutils literal notranslate"><span class="pre">q</span></code><a class="headerlink" href="#understand-p-d-and-q" title="Permalink to this headline">¶</a></h2>
<p>ARIMA models are made up of <a class="reference external" href="http://people.duke.edu/~rnau/411arim.htm">three different terms</a>:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">p</span></code>: The order of the auto-regressive (AR) model.</li>
<li><code class="docutils literal notranslate"><span class="pre">d</span></code>: The degree of differencing.</li>
<li><code class="docutils literal notranslate"><span class="pre">q</span></code>: The order of the moving average (MA) model.</li>
</ul>
<p>Often times, ARIMA models are written in the form <span class="math notranslate">\(ARIMA(p, d, q)\)</span>, where a
model with no differencing term, e.g., <span class="math notranslate">\(ARIMA(1, 0, 12)\)</span>, would be an ARMA
(made up of an auto-regressive term and a moving average term, but no
integrative term).</p>
<div class="section" id="understanding-differencing">
<h3>6.1.1. Understanding differencing<a class="headerlink" href="#understanding-differencing" title="Permalink to this headline">¶</a></h3>
<p>An integrative term, <code class="docutils literal notranslate"><span class="pre">d</span></code>, is typically only used in the case of non-stationary
data. The value of <code class="docutils literal notranslate"><span class="pre">d</span></code> determines the number of periods to lag the response prior
to computing differences. E.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pmdarima.utils</span> <span class="kn">import</span> <span class="n">c</span><span class="p">,</span> <span class="n">diff</span>

<span class="c1"># lag 1, diff 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span>
<span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">differences</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Returns: array([ -6.,  -2.,   7.,  25.], dtype=float32)</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">lag</span></code> and <code class="docutils literal notranslate"><span class="pre">differences</span></code> are not the same!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">differences</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Returns: array([ 4.,  9., 18.], dtype=float32)</span>

<span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">differences</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Returns: array([-8.,  5., 32.], dtype=float32)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">lag</span></code> corresponds to the offset in the time period lag, whereas the
<code class="docutils literal notranslate"><span class="pre">differences</span></code> parameter is the number of times the differences are computed.
Therefore, e.g., for <code class="docutils literal notranslate"><span class="pre">differences=2</span></code>, the procedure is essentially computing
the difference twice:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span>

<span class="c1"># 1</span>
<span class="n">x_lag</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># first lag</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x_lag</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># first difference</span>
<span class="c1"># x = [ -6.,  -2.,   7.,  25.]</span>

<span class="c1"># 2</span>
<span class="n">x_lag</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># second lag</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x_lag</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># x = [ 4.,  9., 18.]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="enforcing-stationarity">
<span id="id1"></span><h2>6.2. Enforcing stationarity<a class="headerlink" href="#enforcing-stationarity" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">pmdarima.arima.stationarity</span></code> sub-module defines various tests of stationarity for
testing a null hypothesis that an observable univariate time series is stationary around
a deterministic trend (i.e. trend-stationary).</p>
<p>A time series is stationary when its mean, variance and auto-correlation, etc.,
are constant over time. Many time-series methods may perform better when a time-series
is stationary, since forecasting values becomes a far easier task for a
stationary time series. ARIMAs that include differencing (i.e., <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>)
assume that the data becomes stationary after differencing. This is called
<strong>difference-stationary</strong>. Auto-correlation plots are an easy way to determine
whether your time series is sufficiently stationary for modeling. If the plot
does not appear relatively stationary, your model will likely need a
differencing term. These can be determined by using an Augmented Dickey-Fuller
test, or various other statistical testing methods. Note that <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code>
will automatically determine the appropriate differencing term for you by default.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pmdarima</span> <span class="kn">as</span> <span class="nn">pm</span>
<span class="kn">from</span> <span class="nn">pmdarima</span> <span class="kn">import</span> <span class="n">datasets</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_lynx</span><span class="p">()</span>
<span class="n">pm</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/lynx_autocorr.png"><img alt="Auto-correlation" class="align-center" src="_images/lynx_autocorr.png" style="width: 640.0px; height: 480.0px;" /></a>
<p>We can examine a time-series’ auto-correlation plot given the code above.
However, to more quantitatively determine whether we need to difference our
data in order to make it stationary, we can conduct an ADF test:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pmdarima.arima.stationarity</span> <span class="kn">import</span> <span class="n">ADFTest</span>

<span class="c1"># Test whether we should difference at the alpha=0.05</span>
<span class="c1"># significance level</span>
<span class="n">adf_test</span> <span class="o">=</span> <span class="n">ADFTest</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">p_val</span><span class="p">,</span> <span class="n">should_diff</span> <span class="o">=</span> <span class="n">adf_test</span><span class="o">.</span><span class="n">is_stationary</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># (0.01, False)</span>
</pre></div>
</div>
<p>The verdict, per the ADF test, is that we should <em>not</em> difference. Pmdarima also
provides a more handy interface for estimating your <code class="docutils literal notranslate"><span class="pre">d</span></code> parameter more directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pmdarima.arima.utils</span> <span class="kn">import</span> <span class="n">ndiffs</span>

<span class="c1"># Estimate the number of differences using an ADF test:</span>
<span class="n">n_adf</span> <span class="o">=</span> <span class="n">ndiffs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s1">&#39;adf&#39;</span><span class="p">)</span>  <span class="c1"># -&gt; 0</span>

<span class="c1"># Or a KPSS test (auto_arima default):</span>
<span class="n">n_kpss</span> <span class="o">=</span> <span class="n">ndiffs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s1">&#39;kpss&#39;</span><span class="p">)</span>  <span class="c1"># -&gt; 0</span>

<span class="c1"># Or a PP test:</span>
<span class="n">n_pp</span> <span class="o">=</span> <span class="n">ndiffs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s1">&#39;pp&#39;</span><span class="p">)</span>  <span class="c1"># -&gt; 0</span>
<span class="k">assert</span> <span class="n">n_adf</span> <span class="o">==</span> <span class="n">n_kpss</span> <span class="o">==</span> <span class="n">n_pp</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<p>The easiest way to make your data stationary in the case of ARIMA models is
to allow <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code> to work its magic, estimate the appropriate <code class="docutils literal notranslate"><span class="pre">d</span></code>
value, and difference the time series accordingly. However, other
common transformations for enforcing stationarity include (sometimes in
combination with one another):</p>
<ul class="simple">
<li>Square root or N-th root transformations</li>
<li>De-trending your time series</li>
<li>Differencing your time series one or more times</li>
<li>Log transformations</li>
</ul>
<p>When in doubt, let the <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code> function do the heavy lifting for you. Read more on
difference stationarity <a class="reference external" href="https://people.duke.edu/~rnau/411diff.htm">in this Duke article</a>.</p>
</div>
<div class="section" id="understand-p-d-q-and-m">
<h2>6.3. Understand <code class="docutils literal notranslate"><span class="pre">P</span></code>, <code class="docutils literal notranslate"><span class="pre">D</span></code>, <code class="docutils literal notranslate"><span class="pre">Q</span></code> and <code class="docutils literal notranslate"><span class="pre">m</span></code><a class="headerlink" href="#understand-p-d-q-and-m" title="Permalink to this headline">¶</a></h2>
<p>Seasonal ARIMA models have three parameters that heavily resemble our <code class="docutils literal notranslate"><span class="pre">p</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code>
parameters:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">P</span></code>: The order of the seasonal component for the auto-regressive (AR) model.</li>
<li><code class="docutils literal notranslate"><span class="pre">D</span></code>: The integration order of the seasonal process.</li>
<li><code class="docutils literal notranslate"><span class="pre">Q</span></code>: The order of the seasonal component of the moving average (MA) model.</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> and be estimated similarly to <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> via <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code>, and
<code class="docutils literal notranslate"><span class="pre">D</span></code> can be estimated via a Canova-Hansen test, however <code class="docutils literal notranslate"><span class="pre">m</span></code> generally requires subject matter
knowledge of the data.</p>
<div class="section" id="estimating-the-seasonal-differencing-term-d">
<span id="seasonality"></span><h3>6.3.1. Estimating the seasonal differencing term, <code class="docutils literal notranslate"><span class="pre">D</span></code><a class="headerlink" href="#estimating-the-seasonal-differencing-term-d" title="Permalink to this headline">¶</a></h3>
<p>Seasonality can manifest itself in timeseries data in unexpected ways. Sometimes
trends are partially dependent on the time of year or month. Other times, they
may be related to weather patterns. In either case, seasonality is a real consideration
that must be made. The pmdarima package provides a test of seasonality for including
seasonal terms in your ARIMA models.</p>
<p>We can use a Canova-Hansen test to estimate our seasonal differencing term:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pmdarima.datasets</span> <span class="kn">import</span> <span class="n">load_lynx</span>
<span class="kn">from</span> <span class="nn">pmdarima.arima.utils</span> <span class="kn">import</span> <span class="n">nsdiffs</span>

<span class="c1"># load lynx</span>
<span class="n">lynx</span> <span class="o">=</span> <span class="n">load_lynx</span><span class="p">()</span>

<span class="c1"># estimate number of seasonal differences</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">nsdiffs</span><span class="p">(</span><span class="n">lynx</span><span class="p">,</span>
            <span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>  <span class="c1"># commonly requires knowledge of dataset</span>
            <span class="n">max_D</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">test</span><span class="o">=</span><span class="s1">&#39;ch&#39;</span><span class="p">)</span>  <span class="c1"># -&gt; 0</span>
</pre></div>
</div>
<p>By default, this will be estimated in <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code> if <code class="docutils literal notranslate"><span class="pre">seasonal=True</span></code>. Make
sure to pay attention to the <code class="docutils literal notranslate"><span class="pre">m</span></code> and the <code class="docutils literal notranslate"><span class="pre">max_D</span></code> parameters.</p>
</div>
<div class="section" id="setting-m">
<span id="period"></span><h3>6.3.2. Setting <code class="docutils literal notranslate"><span class="pre">m</span></code><a class="headerlink" href="#setting-m" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">m</span></code> parameter is the number of observations per seasonal cycle, and is
one that <strong>must be known apriori</strong>. Typically, <code class="docutils literal notranslate"><span class="pre">m</span></code> will correspond to some
recurrent periodicity such as:</p>
<ul class="simple">
<li>7 - daily</li>
<li>12 - monthly</li>
<li>52 - weekly</li>
</ul>
<p>Depending on how it’s set, it can dramatically impact the outcome of an
ARIMA model. For instance, consider the wineind dataset when fit with
<code class="docutils literal notranslate"><span class="pre">m=1</span></code> vs. <code class="docutils literal notranslate"><span class="pre">m=12</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pmdarima</span> <span class="kn">as</span> <span class="nn">pm</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_wineind</span><span class="p">()</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="mi">150</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">150</span><span class="p">:]</span>

<span class="c1"># Fit two different ARIMAs</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">auto_arima</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">error_action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">m12</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">auto_arima</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">error_action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<p>The forecasts these two models will produce are wildly different (code to reproduce):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Plot m=1</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">n_periods</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Test samples vs. forecasts (m=1)&#39;</span><span class="p">)</span>

<span class="c1"># Plot m=12</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m12</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">n_periods</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Test samples vs. forecasts (m=12)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/m_matters.png"><img alt="The 'm' parameter" class="align-center" src="_images/m_matters.png" style="width: 600.0px; height: 400.0px;" /></a>
<p>As you can see, depending on the value of <code class="docutils literal notranslate"><span class="pre">m</span></code>, you may either get a very good model
or a very bad one!!! The author of R’s <code class="docutils literal notranslate"><span class="pre">auto.arima</span></code>, Rob Hyndman, wrote a very good
<a class="reference external" href="https://robjhyndman.com/hyndsight/seasonal-periods/">blog post</a> on the period
of a seasonal time series.</p>
</div>
</div>
<div class="section" id="parallel-vs-stepwise">
<h2>6.4. Parallel vs. stepwise<a class="headerlink" href="#parallel-vs-stepwise" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">auto_arima</span></code> function has two modes:</p>
<ul class="simple">
<li>Stepwise</li>
<li>Parallelized (slower)</li>
</ul>
<p>The parallel approach is a naive, brute force grid search over various combinations
of hyper parameters. It will commonly take longer for several reasons. First of all,
there is no intelligent procedure as to how model orders are tested; they are all
tested (no short-circuiting), which can take a while. Second, there is more overhead
in model serialization due to the method in which <code class="docutils literal notranslate"><span class="pre">joblib</span></code> parallelizes operations.</p>
<p>The stepwise approach follows the strategy laid out by Hyndman and Khandakar in
their <a class="reference external" href="https://www.jstatsoft.org/article/view/v027i03/v27i03.pdf">2008 paper</a>,
<em>“Automatic Time Series Forecasting: The forecast Package for R”</em>.</p>
<p><strong>Step 1</strong>: Try four possible models to start:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math notranslate">\(ARIMA(2, d, 2)\)</span> if <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">1</span></code> and <span class="math notranslate">\(ARIMA(2, d, 2)(1, D, 1)\)</span> if <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">&gt;</span> <span class="pre">1</span></code></li>
<li><span class="math notranslate">\(ARIMA(0, d, 0)\)</span> if <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">1</span></code> and <span class="math notranslate">\(ARIMA(0, d, 0)(0, D, 0)\)</span> if <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">&gt;</span> <span class="pre">1</span></code></li>
<li><span class="math notranslate">\(ARIMA(1, d, 0)\)</span> if <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">1</span></code> and <span class="math notranslate">\(ARIMA(1, d, 0)(1, D, 0)\)</span> if <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">&gt;</span> <span class="pre">1</span></code></li>
<li><span class="math notranslate">\(ARIMA(0, d, 1)\)</span> if <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">1</span></code> and <span class="math notranslate">\(ARIMA(0, d, 1)(0, D, 1)\)</span> if <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">&gt;</span> <span class="pre">1</span></code></li>
</ul>
</div></blockquote>
<p>The model with the smallest AIC (or BIC, or AICc, etc., depending on the minimization criteria)
is selected. This is the “current best” model.</p>
<p><strong>Step 2</strong>: Consider a number of other models:</p>
<blockquote>
<div><ul class="simple">
<li>Where one of <span class="math notranslate">\(p\)</span>, <span class="math notranslate">\(q\)</span>, <span class="math notranslate">\(P\)</span> and <span class="math notranslate">\(Q\)</span> is allowed to vary by <span class="math notranslate">\(\pm 1\)</span> from the current best model</li>
<li>Where <span class="math notranslate">\(p\)</span> and <span class="math notranslate">\(q\)</span> both vary by <span class="math notranslate">\(\pm 1\)</span> from the current best model</li>
<li>Where <span class="math notranslate">\(P\)</span> and <span class="math notranslate">\(Q\)</span> both vary by <span class="math notranslate">\(\pm 1\)</span> from the current best model</li>
</ul>
</div></blockquote>
<p>Whenever a model with a lower information criteria is found, it becomes the new current best model,
and the procedure is repeated until it cannot find a model close to the current best model
with a lower information criterion.</p>
<p>When in doubt, <code class="docutils literal notranslate"><span class="pre">stepwise=True</span></code> is encouraged.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="modules/datasets.html" class="btn btn-neutral float-right" title="7. Toy time-series datasets" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="refreshing.html" class="btn btn-neutral" title="5. Refreshing your ARIMA models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2018, Taylor G Smith

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'1.2.0.dev0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>